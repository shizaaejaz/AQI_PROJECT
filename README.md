This project focuses on predicting the Air Quality Index (AQI) in Karachi for the next three days using historical weather and pollution data. The data was collected from the OpenWeather API over the past year at 5-hour intervals instead of hourly or daily readings. This interval was chosen because consecutive hourly AQI values were often identical, which could cause the model to overfit and lose its predictive strength. For each timestamp, features such as temperature, humidity, wind speed, and pollutant concentrations (PM2.5 and PM10) were retrieved.
To make the AQI values meaningful and globally comparable, the data was converted from OpenWeather’s simple 0–5 scale to the US EPA AQI scale (0–500). This conversion involved calculating separate AQI values for PM2.5 and PM10, mapping their concentrations to EPA-defined ranges, and then selecting the higher value to represent the final AQI. This ensures the AQI reflects the worst-case air quality, which is more relevant for public safety and environmental awareness.
During preprocessing, all missing timestamps and duplicate rows were removed, and data was chronologically sorted. Additional feature engineering was performed to improve model accuracy. Time-based features such as hour, day, month, weekday, and weekend indicators were added. AQI-based features like aqi_change (the difference between consecutive AQI readings) and aqi_change_rate (the relative rate of change) were also derived to capture air quality fluctuations.
Outliers were handled using a capping technique, which limited extreme values that were unusually high or low compared to the rest of the data. This step ensured consistency and prevented the model from being influenced by rare or incorrect readings. The cleaned and processed dataset, referred to as df_capped, was then stored in the Hopsworks Feature Store to maintain reproducibility and make it easily accessible for model training and updates.
For model training, the dataset was split into 80% training and 20% testing sets. Various algorithms were tested, including both parametric models (Linear Regression, Ridge, Lasso, Elastic Net) and non-parametric models (Random Forest, Extra Trees, KNN, XGBoost, SVR), as well as a simple Artificial Neural Network (ANN). To select the most effective model, a combined score was used that considered both accuracy and overfitting risk:
Combined Score = Test RMSE + λ × |Train RMSE − Test RMSE|
This formula penalizes models that perform well on training data but poorly on unseen data, encouraging a balance between fit and generalization.
After evaluating all algorithms, the Random Forest model performed best, achieving the lowest combined score. It was therefore chosen as the final model and saved as best_random_forest.pkl. Using this model, AQI predictions are generated and stored in latest_predictions.csv. These results are visualized through an interactive Streamlit dashboard, allowing users to see upcoming air quality trends in Karachi.
To make the system fully automated, CI/CD pipelines using GitHub Actions were implemented. The pipeline runs every 5 hours, fetching new data, updating the dataset, retraining or reusing the model if necessary, and regenerating fresh predictions. This automation ensures that the AQI forecasts remain current and reliable without manual intervention, creating a complete end-to-end predictive system for Karachi’s air quality.
